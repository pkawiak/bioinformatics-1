var expect = require("expect.js");

var profileMostProbableKmer = require("../../main/js/profileMostProbableKmer");

describe("Profile Most Probable Kmer Spec", function () {

    var text;
    var k;
    var profile;

    it("should process short text", function () {
        //given
        text = "ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT";
        k = 5;
        profile = [
            [0.2, 0.2, 0.3, 0.2, 0.3],
            [0.4, 0.3, 0.1, 0.5, 0.1],
            [0.3, 0.3, 0.5, 0.2, 0.4],
            [0.1, 0.2, 0.1, 0.1, 0.2]
        ];

        //when
        //then
        expect(profileMostProbableKmer(text, k, profile)).to.be("CCGAG");
    });

    it("should process extra dataset", function () {
        //given
        text = "TGCCCGAGCTATCTTATGCGCATCGCATGCGGACCCTTCCCTAGGCTTGTCGCAAGCCATTATCCTGGGCGCTAGTTGCGCGAGTATTGTCAGACCTGATGACGCTGTAAGCTAGCGTGTTCAGCGGCGCGCAATGAGCGGTTTAGATCACAGAATCCTTTGGCGTATTCCTATCCGTTACATCACCTTCCTCACCCCTA";
        k = 6;
        profile = [
            [0.364, 0.333, 0.303, 0.212, 0.121, 0.242],
            [0.182, 0.182, 0.212, 0.303, 0.182, 0.303],
            [0.121, 0.303, 0.182, 0.273, 0.333, 0.303],
            [0.333, 0.182, 0.303, 0.212, 0.364, 0.152]
        ];

        //when
        //then
        expect(profileMostProbableKmer(text, k, profile)).to.be("TGTCGC");
    });

    it("should process data challenge", function () {
        //given
        text = "GTGTAAAAAACCCACGCGTAGGCATAGGAGGTTCTAAACAGTTCCGCGGCGCAACCTTGCGACTTAACCGTGCAGCGCAAATAACAGGCAACGATTCTGGTGCGTTGTACCAGCTAATCTCCGGTTGATGCCAAGGGCCGACAAGTCTAGGCCCTGCCAGTTCGTCCGTAGTTTCACTAGTGCAGTGGCATGCAATGAGGTGCGTTATAGAATTAAGCCTCAAGGTGCGTATGCGGTACAGTCGATGTGCAATCGTTGTAAGCCAATTCTATTGAAACCCAGTCGGTTTATCCCGTTCATCTCCAAAGCTGCACCCTACCTACTAACAATATTTTTGCTCAGCAACAGTGCCTAAACACATCGGCCGTATACACTCCGTCTCCTTTCGCATACTCGTATCATTAGAGGGACAAAGTTTTAGACACTCCTCTCCAGATCCATGATTTAGACGCTATCAGACAAATAAAGTTGCGCCTAACTCTCCTCCGTTATGGGTCCACGCAGTCAGCGCTCCGATTCTTATGTTCGTGCGACTGAAACTCAGGTGCGAAGACCGTGAAGACGCTAAATACCAGAGGAACTCGGGTCGCCGCTCTCAAAACCCCCGTGTATTGGCGGACGTTCTTTGTTATTGTCGCACCGTGGGATTCCCAGTAAAAATCAGGATGTAGCCGGTCTGGATCACGTAGTGGACATATGGACAGAATTCATTTATTTACAGGTGATGAGTTAATGAGAGAGGAGACATAGCTTGTCATAGACGCGGGCATTAAAAGGTGACAAAACCACGCATAGCTCGTGAATCGAATGAGCAGTATACATCCACCTGGGTTCGGCCTCCTCAATCCCCGCTTTGTTTCGACGCTTCCTAATTTCAATCTATCAGGGGTACCATCGCCCCTTATAACCAGGCACACTGGATCTTCAATGCCGGAGTCCAGCTGCTAGTTGCCGTTATCCTATCGACTGTTGCTACGAAGGCGCACGATTAATTCGTTCC";
        k = 13;
        profile = [
            [0.355, 0.118, 0.289, 0.224, 0.237, 0.342, 0.171, 0.276, 0.197, 0.211, 0.276, 0.25, 0.263],
            [0.145, 0.25, 0.237, 0.263, 0.25, 0.224, 0.237, 0.211, 0.303, 0.211, 0.25, 0.303, 0.224],
            [0.276, 0.342, 0.237, 0.25, 0.224, 0.132, 0.329, 0.303, 0.276, 0.237, 0.224, 0.197, 0.263],
            [0.224, 0.289, 0.237, 0.263, 0.289, 0.303, 0.263, 0.211, 0.224, 0.342, 0.25, 0.25, 0.25]
        ];

        //when
        //then
        expect(profileMostProbableKmer(text, k, profile)).to.be("ATAACAGGCAACG");
    });

});